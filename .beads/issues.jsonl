{"id":"bd-16m","title":"PRM-VAC-0005: Deterministic sorting + JSONL emission","description":"Implement deterministic record ordering and JSONL stream emission over collected record sets.\\n\\n## Acceptance Criteria\\n- Records are sorted by (relative_path, root) lexicographic byte order before output.\\n- Stdout emits one JSON object per line (JSONL) with version=vacuum.v0.\\n- Multiple roots with same relative_path are disambiguated by root ordering deterministically.\\n\\n## Notes\\nBoundary: emission/order contract only. This bead is independent of include/exclude filtering logic and can operate on any collected record vector.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.730829Z","created_by":"zac","updated_at":"2026-02-25T04:20:21.952979Z","compaction_level":0,"original_size":0,"labels":["determinism","output","vacuum"],"dependencies":[{"issue_id":"bd-16m","depends_on_id":"bd-gau","type":"blocks","created_at":"2026-02-25T04:12:42.671520Z","created_by":"zac"}]}
{"id":"bd-17v","title":"PRM-VAC-0002: Root validation + refusal envelopes","description":"Implement root validation and refusal envelope handling before scan start.\n\n## Acceptance Criteria\n- Empty roots, non-existent roots, unreadable roots trigger exit 2 with refusal envelope on stdout.\n- Refusal codes implemented: E_ROOT_NOT_FOUND, E_ROOT_PERMISSION, E_IO with detail payloads matching plan.\n- Multi-root validation is fail-fast on first invalid root.\n\n## Notes\nBoundary: root-level refusal behavior only; per-file skips are handled in separate bead.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.583204Z","created_by":"zac","updated_at":"2026-02-26T03:43:35.863900Z","closed_at":"2026-02-26T03:43:35.863793Z","close_reason":"Completed: added root validation with fail-fast behavior and refusal envelopes for empty/nonexistent/unreadable roots plus E_ROOT_NOT_FOUND/E_ROOT_PERMISSION/E_IO payloads; quality gate passed.","compaction_level":0,"original_size":0,"labels":["cli","refusal","vacuum"],"dependencies":[{"issue_id":"bd-17v","depends_on_id":"bd-3ue","type":"blocks","created_at":"2026-02-25T04:20:21.863432Z","created_by":"zac"}]}
{"id":"bd-1dk","title":"PRM-VAC-0007: MIME mapping + path normalization","description":"Implement extension-based MIME guesser and path normalization helpers.\n\n## Acceptance Criteria\n- Built-in extension mapping covers minimum set in PLAN.md (csv/tsv/txt/json/jsonl/xml/pdf/xlsx/xls/parquet/zip/gz/yaml/yml).\n- Unknown extensions map to null.\n- relative_path always uses forward slashes; path/root remain OS-native.\n\n## Notes\nBoundary: heuristic mapping only; no magic-bytes detection in v0.1.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.828568Z","created_by":"zac","updated_at":"2026-02-26T03:44:50.937203Z","closed_at":"2026-02-26T03:44:50.937095Z","close_reason":"Completed: finalized extension-based MIME mapping for PLAN minimum set, added null behavior for unknowns, and added path normalization helpers/tests for forward-slash relative paths with OS-native path strings; quality gate passed.","compaction_level":0,"original_size":0,"labels":["mime","path","vacuum"]}
{"id":"bd-1f2","title":"PRM-VAC-0008: Witness append + --no-witness","description":"Add ambient witness recording for scan/refusal runs with --no-witness bypass.\n\n## Acceptance Criteria\n- Successful and refusal runs append witness.v0 record by default.\n- --no-witness suppresses writes without changing domain exit code.\n- Ledger resolution follows EPISTEMIC_WITNESS then ~/.epistemic/witness.jsonl.\n\n## Notes\nBoundary: run-time witness append only; query CLI in follow-up bead.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.879043Z","created_by":"zac","updated_at":"2026-02-25T04:17:24.503277Z","compaction_level":0,"original_size":0,"labels":["spine","vacuum","witness"],"dependencies":[{"issue_id":"bd-1f2","depends_on_id":"bd-16m","type":"blocks","created_at":"2026-02-25T04:12:42.852449Z","created_by":"zac"},{"issue_id":"bd-1f2","depends_on_id":"bd-17v","type":"blocks","created_at":"2026-02-25T04:17:24.503239Z","created_by":"zac"},{"issue_id":"bd-1f2","depends_on_id":"bd-3ue","type":"blocks","created_at":"2026-02-25T04:12:42.805786Z","created_by":"zac"}]}
{"id":"bd-1km","title":"PRM-VAC-0009: Witness query/last/count CLI","description":"Implement witness CLI subcommands query/last/count for vacuum.\n\n## Acceptance Criteria\n- vacuum witness query/last/count subcommands work with json and human output modes as documented.\n- Filters (tool/since/until/outcome/input-hash/limit) operate correctly for query/count.\n- Exit behavior for empty/no-match states is consistent with spine witness conventions.\n\n## Notes\nDepends on witness ledger implementation from PRM-VAC-0008.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.925326Z","created_by":"zac","updated_at":"2026-02-25T04:12:42.898Z","compaction_level":0,"original_size":0,"labels":["cli","vacuum","witness"],"dependencies":[{"issue_id":"bd-1km","depends_on_id":"bd-1f2","type":"blocks","created_at":"2026-02-25T04:12:42.897963Z","created_by":"zac"}]}
{"id":"bd-1rl","title":"PRM-VAC-0013: --schema output","description":"Implement --schema flag for JSON Schema output (deferred scope item).\n\n## Acceptance Criteria\n- --schema prints valid JSON Schema for vacuum.v0 record and exits 0 before root validation.\n- Schema includes optional _skipped/_warnings fields and tool_versions object.\n- Regression test validates schema JSON structure and required fields.\n\n## Notes\nDeferred scope; schedule after v0.1 must-have path is stable.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-25T04:11:55.123752Z","created_by":"zac","updated_at":"2026-02-25T04:16:07.313991Z","compaction_level":0,"original_size":0,"labels":["deferred","schema","vacuum"]}
{"id":"bd-1st","title":"PRM-VAC-0012: Core scanner contract test suite","description":"Implement core v0.1 scanner tests for traversal/filter/refusal/record contracts (excluding witness-specific and golden-specific suites).\\n\\n## Acceptance Criteria\\n- Tests cover: basic scan, include/exclude filtering, symlink mode behavior, skipped record contract, MIME mapping, path normalization, refusals, and exit codes.\\n- Core tests run under cargo test without network/external dependencies.\\n- Witness-specific tests are not included here (PRM-VAC-0016), and golden/idempotency snapshots are not included here (PRM-VAC-0017).\\n\\n## Notes\\nThis bead intentionally focuses on fast feedback core correctness.","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-25T04:11:55.072921Z","created_by":"zac","updated_at":"2026-02-25T04:14:18.890924Z","compaction_level":0,"original_size":0,"labels":["coverage","tests","vacuum"],"dependencies":[{"issue_id":"bd-1st","depends_on_id":"bd-16m","type":"blocks","created_at":"2026-02-25T04:12:43.172764Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-17v","type":"blocks","created_at":"2026-02-25T04:12:43.080638Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-1dk","type":"blocks","created_at":"2026-02-25T04:12:43.262887Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-2tc","type":"blocks","created_at":"2026-02-25T04:12:43.127372Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-316","type":"blocks","created_at":"2026-02-25T04:12:43.216103Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-3be","type":"blocks","created_at":"2026-02-25T04:12:43.388203Z","created_by":"zac"},{"issue_id":"bd-1st","depends_on_id":"bd-je4","type":"blocks","created_at":"2026-02-25T04:12:43.033915Z","created_by":"zac"}]}
{"id":"bd-252","title":"PRM-VAC-0014: --progress structured reporting","description":"Implement structured progress reporting to stderr via --progress (deferred scope item).\n\n## Acceptance Criteria\n- --progress emits JSONL progress records at configured cadence and immediate warning records for skipped files.\n- Without --progress, stderr remains unstructured warning lines only.\n- Tests validate progress payload structure and non-interference with stdout JSONL manifest.\n\n## Notes\nDeferred scope; performance tuning may follow initial correctness.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-25T04:11:55.176131Z","created_by":"zac","updated_at":"2026-02-25T04:18:32.605963Z","compaction_level":0,"original_size":0,"labels":["deferred","progress","vacuum"],"dependencies":[{"issue_id":"bd-252","depends_on_id":"bd-16m","type":"blocks","created_at":"2026-02-25T04:12:42.988767Z","created_by":"zac"},{"issue_id":"bd-252","depends_on_id":"bd-gau","type":"blocks","created_at":"2026-02-25T04:12:42.943279Z","created_by":"zac"}]}
{"id":"bd-2tc","title":"PRM-VAC-0004: Include/exclude glob filtering","description":"Implement include/exclude glob filtering against normalized relative_path as a standalone filter layer.\\n\\n## Acceptance Criteria\\n- Include patterns are OR-matched; exclude patterns override include matches.\\n- Matching uses forward-slash normalized relative_path on all platforms.\\n- Pattern behavior aligns with plan examples for *, **, ?, character classes.\\n- Filtering logic is testable independently from directory traversal implementation.\\n\\n## Notes\\nBoundary: filtering of leaf files only; directory traversal remains unconditional and can integrate this layer later.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.681044Z","created_by":"zac","updated_at":"2026-02-26T03:52:33.172898Z","closed_at":"2026-02-26T03:52:33.172802Z","close_reason":"Completed: include/exclude filtering layer implemented with globset over normalized relative_path; include OR semantics, exclude precedence, and glob operators (*, **, ?, classes) are covered by independent unit tests; quality gate passed.","compaction_level":0,"original_size":0,"labels":["filtering","glob","vacuum"],"dependencies":[{"issue_id":"bd-2tc","depends_on_id":"bd-1dk","type":"blocks","created_at":"2026-02-25T04:18:32.561608Z","created_by":"zac"}]}
{"id":"bd-2x1","title":"PRM-VAC-0015: Decide multi-root collision policy","description":"Resolve multi-root relative_path collision policy from open question in plan.\n\n## Acceptance Criteria\n- Decision recorded in docs/PLAN.md or a dedicated ADR with chosen policy and rationale.\n- Downstream compatibility impact on lock/path identity is documented.\n- If policy requires behavior change, follow-up implementation bead is created and linked.\n\n## Notes\nDecision bead only; do not silently change scanner output semantics without explicit decision.","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-25T04:11:55.227063Z","created_by":"zac","updated_at":"2026-02-25T04:18:32.667260Z","compaction_level":0,"original_size":0,"labels":["decision","design","vacuum"]}
{"id":"bd-316","title":"PRM-VAC-0006: _skipped record contract","description":"Implement per-file failure handling as _skipped records with warnings.\n\n## Acceptance Criteria\n- Stat/read failures on individual files produce _skipped=true records (not refusal).\n- Skipped records set size=null and mtime=null while preserving path/root/relative_path and extension/mime when derivable.\n- _warnings includes tool/code/message/detail payload with E_IO-style detail.\n\n## Notes\nNon-goal: root-level scan refusal (handled by PRM-VAC-0002).","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.777863Z","created_by":"zac","updated_at":"2026-02-25T04:17:24.457311Z","compaction_level":0,"original_size":0,"labels":["errors","schema","vacuum"],"dependencies":[{"issue_id":"bd-316","depends_on_id":"bd-1dk","type":"blocks","created_at":"2026-02-25T04:17:24.457270Z","created_by":"zac"},{"issue_id":"bd-316","depends_on_id":"bd-gau","type":"blocks","created_at":"2026-02-25T04:12:42.759780Z","created_by":"zac"}]}
{"id":"bd-36h","title":"PRM-VAC-0016: Witness test suite","description":"Add witness-focused tests for append and witness CLI behavior.\\n\\n## Acceptance Criteria\\n- Tests cover witness append on SCAN_COMPLETE and REFUSAL outcomes.\\n- Tests cover --no-witness suppression semantics.\\n- Tests cover vacuum witness query/last/count filtering and exit behavior (json + human modes).\\n\\n## Notes\\nScope limited to witness subsystem behavior; core scanner contracts and golden output live in separate beads.","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-25T04:14:13.244607Z","created_by":"zac","updated_at":"2026-02-25T04:14:18.664378Z","compaction_level":0,"original_size":0,"labels":["tests","vacuum","witness"],"dependencies":[{"issue_id":"bd-36h","depends_on_id":"bd-1f2","type":"blocks","created_at":"2026-02-25T04:14:18.571457Z","created_by":"zac"},{"issue_id":"bd-36h","depends_on_id":"bd-1km","type":"blocks","created_at":"2026-02-25T04:14:18.617509Z","created_by":"zac"},{"issue_id":"bd-36h","depends_on_id":"bd-je4","type":"blocks","created_at":"2026-02-25T04:14:18.664333Z","created_by":"zac"}]}
{"id":"bd-3be","title":"PRM-VAC-0010: operator.json + --describe","description":"Add operator manifest and --describe plumbing.\n\n## Acceptance Criteria\n- operator.json is embedded/served with schema_version/operator metadata from plan.\n- --describe prints operator manifest and exits 0 before root validation.\n- Manifest refusal/exit_code/pipeline blocks match documented semantics.\n\n## Notes\nNon-goal: schema JSON output and progress stream (separate deferred beads).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-25T04:11:54.974717Z","created_by":"zac","updated_at":"2026-02-26T03:46:32.618730Z","closed_at":"2026-02-26T03:46:32.618623Z","close_reason":"Completed: added operator.json manifest, embedded --describe output before root validation, and regression tests for manifest structure","compaction_level":0,"original_size":0,"labels":["docs","operator","vacuum"]}
{"id":"bd-3ue","title":"PRM-VAC-0001: Scaffold crate + CLI surface","description":"Build the Rust project scaffold and CLI entry surface per docs/PLAN.md execution flow.\n\n## Acceptance Criteria\n- Cargo crate has src/main.rs and src/lib.rs with run() -> u8 exit mapping.\n- CLI supports positional ROOTS + subcommand shell for witness + flags: include/exclude/no-follow/no-witness/describe/schema/progress/version.\n- Module layout created as documented (cli, walk, record, output, refusal, witness).\n\n## Notes\nBoundary: skeleton and argument plumbing only; no filesystem traversal logic in this bead.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-25T04:11:54.535665Z","created_by":"zac","updated_at":"2026-02-26T03:40:54.201028Z","closed_at":"2026-02-26T03:40:54.200917Z","close_reason":"Completed: scaffolded crate entrypoints, CLI arg surface, and module layout; quality gate passed (fmt, clippy -D warnings, test).","compaction_level":0,"original_size":0,"labels":["cli","core","vacuum"]}
{"id":"bd-gau","title":"PRM-VAC-0003: Recursive walker + symlink behavior","description":"Implement recursive directory traversal with walkdir and symlink behavior from plan.\n\n## Acceptance Criteria\n- Scans one or more roots recursively and collects file entries.\n- Default follows symlinks; --no-follow disables symlink-directory traversal and uses link metadata semantics.\n- Symlink cycles do not crash scan.\n\n## Notes\nBoundary: entry collection only; filtering/sorting/output in downstream beads.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-02-25T04:11:54.632297Z","created_by":"zac","updated_at":"2026-02-26T03:50:07.147158Z","closed_at":"2026-02-26T03:50:07.147040Z","close_reason":"Completed: implemented recursive multi-root walkdir scanning, follow/no-follow symlink behavior, cycle-safe traversal, and walker unit tests","compaction_level":0,"original_size":0,"labels":["filesystem","vacuum","walker"]}
{"id":"bd-je4","title":"PRM-VAC-0011: Build fixture corpus","description":"Build test fixture corpus for scanner behavior and edge handling.\n\n## Acceptance Criteria\n- tests/fixtures includes simple, nested, empty_dir, symlinks, and mixed directories.\n- Fixture README documents intent and expected behaviors for each fixture set.\n- Fixtures are stable for deterministic ordering and size assertions.\n\n## Notes\nThis bead prepares data only; assertion logic lives in test-suite bead.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-25T04:11:55.023114Z","created_by":"zac","updated_at":"2026-02-26T03:47:46.679338Z","closed_at":"2026-02-26T03:47:46.679227Z","close_reason":"Completed: added deterministic fixture corpus (simple/nested/empty_dir/symlinks/mixed) plus fixture README documenting intent and expectations","compaction_level":0,"original_size":0,"labels":["fixtures","tests","vacuum"]}
{"id":"bd-ti2","title":"PRM-VAC-0017: Golden + idempotency test suite","description":"Add deterministic golden-file and idempotency tests for scanner output.\\n\\n## Acceptance Criteria\\n- Golden tests for baseline scan, include-only, and exclude behavior compare structurally while normalizing variable absolute-path/mtime fields.\\n- Idempotency test proves same directory scanned twice yields equivalent ordered record set.\\n- Tests verify stable ordering contract for (relative_path, root).\\n\\n## Notes\\nScope limited to deterministic output contracts; witness behavior is covered in PRM-VAC-0016.","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-25T04:14:13.293655Z","created_by":"zac","updated_at":"2026-02-25T04:14:18.801531Z","compaction_level":0,"original_size":0,"labels":["golden","tests","vacuum"],"dependencies":[{"issue_id":"bd-ti2","depends_on_id":"bd-16m","type":"blocks","created_at":"2026-02-25T04:14:18.710667Z","created_by":"zac"},{"issue_id":"bd-ti2","depends_on_id":"bd-2tc","type":"blocks","created_at":"2026-02-25T04:14:18.757062Z","created_by":"zac"},{"issue_id":"bd-ti2","depends_on_id":"bd-je4","type":"blocks","created_at":"2026-02-25T04:14:18.801490Z","created_by":"zac"}]}
